---
// SEO.astro: Global SEO, AEO, GEO meta and structured data

interface FAQItem {
  question: string;
  answer: string;
}
interface HowToStep {
  name: string;
  text: string;
}
interface Props {
  title?: string;
  description?: string;
  url?: string;
  image?: string;
  type?: string;
  siteName?: string;
  twitterHandle?: string;
  schema?: any;
  faqs?: FAQItem[];
  howto?: { name: string; steps: HowToStep[] };
  summary?: string;
}


const {
  title = 'HeyOz',
  description = 'Welcome to HeyOz',
  url = 'https://hey-oz-frontend.vercel.app/',
  image = '/favicon.svg',
  type = 'website',
  siteName = 'HeyOz',
  twitterHandle = '@HeyOz',
  schema = null,
  faqs = null,
  howto = null,
  summary = null
} = Astro.props;
---


<!-- Primary Meta Tags -->
<title>{title}</title>
<meta name="description" content={description} />
<link rel="canonical" href={url} />
{summary && <meta name="generative-summary" content={summary} />}

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:url" content={url} />
<meta property="og:image" content={image} />
<meta property="og:site_name" content={siteName} />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={image} />
<meta name="twitter:site" content={twitterHandle} />


<!-- JSON-LD Structured Data -->

{schema && typeof schema === 'object' && Object.keys(schema).length > 0 && (
  <script type="application/ld+json">
    {(() => {
      try {
        return JSON.stringify(schema);
      } catch (e) {
        return '';
      }
    })()}
  </script>
)}

{Array.isArray(faqs) && faqs.length > 0 && faqs.every(faq => faq && faq.question && faq.answer) && (
  <script type="application/ld+json">
    {(() => {
      try {
        return JSON.stringify({
          "@context": "https://schema.org",
          "@type": "FAQPage",
          "mainEntity": faqs.map(faq => ({
            "@type": "Question",
            "name": faq.question,
            "acceptedAnswer": {
              "@type": "Answer",
              "text": faq.answer
            }
          }))
        });
      } catch (e) {
        return '';
      }
    })()}
  </script>
)}

{howto && typeof howto === 'object' && howto.name && Array.isArray(howto.steps) && howto.steps.length > 0 && howto.steps.every(step => step && step.name && step.text) && (
  <script type="application/ld+json">
    {(() => {
      try {
        return JSON.stringify({
          "@context": "https://schema.org",
          "@type": "HowTo",
          "name": howto.name,
          "step": howto.steps.map(step => ({
            "@type": "HowToStep",
            "name": step.name,
            "text": step.text
          }))
        });
      } catch (e) {
        return '';
      }
    })()}
  </script>
)}
